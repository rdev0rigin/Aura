<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Web Client</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
</head>
<body>
    <button onclick="onPub()">Publish</button>

	<div id="SubscriptionTest">

		<input type="text" id="RealmInput">
		<button onclick="subscribe(document.getElementById('RealmInput').value)">Subscribe</button>
	</div>

	<script src="https://unpkg.com/autobahn-browser@^18/autobahn.js"></script>
	<script>
		try {
			// for Node.js
			var autobahn = require('autobahn');
		} catch (e) {
			// for browsers (where AutobahnJS is available globally)
		}
		const connection = new autobahn.Connection({url: 'ws://127.0.0.1:3131/', realm: 'nexus.aura.realm.1'});
        let session = {};
		connection.onopen = (sess) => session = sess;
			// 1) subscribe to a topic
		function onevent(args) {
			console.log("Event:", args[0]);
		}



			// 3) register a procedure for remoting
			// function add2(args) {
			//     return args[0] + args[1];
			// }
			// session.register('com.myapp.add2', add2);
			//
			// 4) call a remote procedure
			// session.call('com.myapp.add2', [2, 3]).then(
			//     function (res) {
			//         console.log("Result:", res);
			//     }
			// );

		function subscribe(realm) {
			session.subscribe(realm, onevent);
		}

		function onPub() {
			sess.publish('hello.wamp', ['Hello, Nexus!']);
        }
		connection.open();
	</script>

</body>
</html>